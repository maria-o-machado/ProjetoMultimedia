<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>Nivel9</title>
    <script src="//cdn.jsdelivr.net/phaser/2.2.2/phaser.min.js"></script>
    <style type="text/css">
        body {
            margin: 0;
        }
    </style>
</head>
<body>

<script type="text/javascript">

var game = new Phaser.Game(1344 , 750, Phaser.AUTO, '', { preload: preload, create: create, update: update });

var plataformas;
var player;
var cursors;
var poderCons=0;
var poderConsVel=0;
var stars;
var mulher;
var score = 0;
var timeout;
var timeout2;
var audio;
var musicaPoder;
var matarMulher;
var apanharMas;
var apanharBoas;
var sons;
var musica;

var tfinalImunidade = 0;
var tempoImunidade = 0;
var contadorImunidade=0;

var tfinalVelocidade = 0;
var tempoVelocidade = 0;
var contadorVelocidade = 0;

var tfinalTamanho = 0;
var tempoTamanho = 0;
var contadorTamanho = 0;

function preload() {
	game.load.image('background', '../resources/backgroundinterior2.jpg');
	game.load.image('saude', '../resources/saude.png');
	game.load.image('saudenivel', '../resources/saudenivel.png');
	game.load.image('chaointerior', '../resources/chaointerior.png');
	game.load.tilemap('mapa', '../resources/nivel9.json', null, Phaser.Tilemap.TILED_JSON);
	game.load.image('queijoBom', '../resources/QueijoBom.png');
	game.load.image('queijoVenenoso', '../resources/QueijoVenenoso.png');
	game.load.image('toca', '../resources/Toca.png');
	game.load.image('poder', '../resources/Poderes.png');
	game.load.image('poderAumenta', '../resources/poderAumenta.png');
	game.load.image('armadilha', '../resources/Armadilha3.png');
	game.load.image('buttonPausa', '../resources/botoes/pausa.png');
	game.load.image('buttonMenu', '../resources/botoes/menu.png');
	game.load.image('buttonNiveis', '../resources/botoes/niveis.png');
	game.load.image('buttonSair', '../resources/botoes/sair.png');
	game.load.image('buttonContinuar', '../resources/botoes/continuar.png');
	game.load.image('caixaPausa', '../resources/caixa.png');
	game.load.image('textMusica', '../resources/musica.png');
	game.load.image('textSons', '../resources/sons.png');
	game.load.image('buttonSonsOn', '../resources/botoes/on.png');
	game.load.image('buttonSonsOff', '../resources/botoes/off.png');
	game.load.image('buttonMusicaOn', '../resources/botoes/on.png');
	game.load.image('buttonMusicaOff', '../resources/botoes/off.png');
	game.load.image('buttonSonsOnDesativado', '../resources/botoes/onBlack.png');
	game.load.image('buttonSonsOffDesativado', '../resources/botoes/offBlack.png');
	game.load.image('buttonMusicaOnDesativado', '../resources/botoes/onBlack.png');
	game.load.image('buttonMusicaOffDesativado', '../resources/botoes/offBlack.png');
	game.load.spritesheet('pessoa', '../resources/pessoas.png',1010,2430);
	game.load.spritesheet('rato', '../resources/ratos.png', 166.7, 90);
	game.load.bitmapFont('myfont', '../resources/font.png', '../resources/font.fnt');
	game.load.audio('musica', '../resources/musica1.mp3');
	game.load.audio('musicaPoderes', '../resources/musicaPoderes.mp3');
	game.load.audio('musicaMatarmulher', '../resources/matarMulher.mp3');
	game.load.audio('musicaBoas', '../resources/apanharQueijoBom.mp3');
	game.load.audio('musicaMas', '../resources/apanharCoisasMas.mp3');
}


function create() {
	audio = game.add.audio('musica');
	musicaPoder = game.add.audio('musicaPoderes');
	matarMulher = game.add.audio('musicaMatarmulher');
	apanharBoas = game.add.audio('musicaBoas');
	apanharMas = game.add.audio('musicaMas');
	musica=localStorage.getItem("musica");
	sons=localStorage.getItem("sons");
	if(musica=="on"){
    	audio.play();
  	}
	//  We're going to be using physics, so enable the Arcade Physics system
	game.physics.startSystem(Phaser.Physics.ARCADE);
	game.scale.pageAlignVertically = true;
	game.scale.pageAlignHorizontally = true;

	//  A simple background for our game
	game.add.tileSprite(0, 0, 6000,750,'background');
	game.world.setBounds(0, 0, 6000, 750);

	map = game.add.tilemap('mapa');
	map.addTilesetImage( 'chaointerior');
	map.setCollision([1,2]);
	layer = map.createLayer('Camada de Tiles 1');
	//layer.debug = true;

	timeImunidade = game.add.bitmapText(50, 200, 'myfont', String(parseInt(tempoImunidade)), 40);

	timeVelocidade = game.add.bitmapText(50, 300, 'myfont', String(parseInt(tempoVelocidade)), 40);

	timeTamanho = game.add.bitmapText(50, 400, 'myfont', String(parseInt(tempoTamanho)), 40);

	time= game.add.bitmapText( 1350/2-20, 20, 'myfont', String(parseInt(game.time.totalElapsedSeconds())), 40);
	time.fixedToCamera=true;
	time.tint=0xfa0013;


	displayscore= game.add.bitmapText(1000, 20, 'myfont',String( score), 40);
	displayscore.fixedToCamera=true;
	nometime=game.add.bitmapText( 1350/2-160, 20, 'myfont', "TIME:", 40);
	nomescore=game.add.bitmapText( 820, 20, 'myfont', "SCORE:", 40);
	nomescore.fixedToCamera=true;
	nometime.fixedToCamera=true;
	displayscore.tint=0xfa0013;
	nomesaude=game.add.bitmapText( 30, 20, 'myfont', "SAUDE:", 40);
    saudenivel= game.add.sprite(220, 15, 'saude');
    barrasaude= game.add.sprite(220, 15, 'saudenivel');

	barrasaude.fixedToCamera=true;
	saudenivel.fixedToCamera=true;
	nomesaude.fixedToCamera=true;

	saudenivel.width=280;
	barrasaude.width=280;


	player = game.add.sprite(5, game.world.height - 630 , 'rato');

	// We need to enable physics on the player
	game.physics.arcade.enable(player);

	// Player physics properties. Give the little guy a slight bounce.
	player.body.bounce.y = 0.3;
	player.body.gravity.y = 800;
	player.body.collideWorldBounds = false;
	player.width=104;
	player.height=56;
	player.goesRight=true;
	player.anchor.setTo(0, -0.5);
  	player.body.setSize(129, 69, 12,19 );

	//  Our two animations, walking left and right.
	player.animations.add('left', [0, 1, 2, 3, 4, 5], 20, true);
	player.animations.add('right', [6, 7, 8, 9, 10, 11], 20, true);

	//QUEIJOS BONS
	queijosB = game.add.group();
	queijosB.enableBody = true;

	queijoB = queijosB.create(815, game.world.height-150, 'queijoBom');
	queijoB.body.gravity.y = 100;
	queijoB.height=50;
	queijoB.width=50;

	queijoB = queijosB.create(825, game.world.height-150, 'queijoBom');
	queijoB.body.gravity.y = 100;
	queijoB.height=50;
	queijoB.width=50;

	queijoB = queijosB.create(2415, game.world.height-800, 'queijoBom');
	queijoB.body.gravity.y = 100;
	queijoB.height=50;
	queijoB.width=50;

	//QUEIJOS VENENOSOS
	queijosV = game.add.group();
	queijosV.enableBody = true;
	game.physics.arcade.enable(queijosV);

	queijoV=queijosV.create(1810, game.world.height-650,'queijoVenenoso');
	queijoV.body.gravity.y = 100;
	queijoV.height=50;
	queijoV.width=50;

	queijoV=queijosV.create(4200, game.world.height-650,'queijoVenenoso');
	queijoV.body.gravity.y = 100;
	queijoV.height=50;
	queijoV.width=50;

	queijoV=queijosV.create(4250, game.world.height-650,'queijoVenenoso');
	queijoV.body.gravity.y = 100;
	queijoV.height=50;
	queijoV.width=50;

	//HUMANOS

	mulher = game.add.sprite(1640, game.world.height - 410 , 'pessoa');
	mulher.width=86
	mulher.height=200
	game.physics.arcade.enable(mulher);
	mulher.body.collideWorldBounds = true;
	mulher.animations.add('left', [0], 9, true);
	mulher.animations.add('right', [1], 9, true);
	mulher.body.velocity.x = 300;
	mulher.animations.play('right');

	mulher1 = game.add.sprite(2430, game.world.height - 440 , 'pessoa');
	mulher1.width=86
	mulher1.height=200
	game.physics.arcade.enable(mulher1);
	mulher1.body.collideWorldBounds = true;
	mulher1.animations.add('left', [0], 9, true);
	mulher1.animations.add('right', [1], 9, true);
	mulher1.body.velocity.x = 300;
	mulher1.animations.play('right');

	//ARMADILHAS
	armadilhas = game.add.group();
	game.physics.arcade.enable(armadilhas);
	armadilhas.enableBody = true;

	armadilha=armadilhas.create(960, game.world.height-660,'armadilha');
	armadilha.body.gravity.y = 100;

	armadilha=armadilhas.create(1170, game.world.height-660,'armadilha');
	armadilha.body.gravity.y = 100;

	armadilha=armadilhas.create(1380, game.world.height-660,'armadilha');
	armadilha.body.gravity.y = 100;

	armadilha=armadilhas.create(3300, game.world.height-660,'armadilha');
	armadilha.body.gravity.y = 100;

	armadilha=armadilhas.create(5075, game.world.height-150,'armadilha');
	armadilha.body.gravity.y = 100;

	//PODER
	poderes = game.add.group();
	game.physics.arcade.enable(poderes);
	poderes.enableBody = true;
	poderesImunidade=poderes.create(1930, game.world.height-700,'poder');
	poderesImunidade.width=60;
	poderesImunidade.height=60;
	poderesImunidade.body.gravity.y = 100;

	poderesVelocidade=poderes.create(575, game.world.height-700,'poder');
	poderesVelocidade.width=60;
	poderesVelocidade.height=60;
	poderesVelocidade.body.gravity.y = 100;
	poderesVelocidade.tint=0xFFFF00;

	poderesTamanho = game.add.sprite(20, game.world.height - 200, 'poderAumenta');
	game.physics.arcade.enable(poderesTamanho);
	poderesTamanho.height=45;
	poderesTamanho.width=45;

	//TOCA
	passa = game.add.sprite(5880, game.world.height-465, 'toca');
	game.physics.arcade.enable(passa);
	passa.height = 75;
	passa.width = 94;
	game.camera.follow(player);

  button = game.add.button(1200, 10, 'buttonPausa');
	button.height=49.35;
	button.width=120.3;
	button.fixedToCamera=true;
  button.onInputOver.add(over, this);
	button.onInputUp.add(function () {
	this.game.canvas.style.cursor = "default";
  // When the paus button is pressed, we pause the game
  game.paused = true;
	caixa = game.add.sprite(392, game.world.height - 570 , 'caixaPausa');
	caixa.width=571.2;
	caixa.height=417.2;
	buttonContinuar = game.add.button(1200, 10, 'buttonContinuar');
	buttonContinuar.height=49.35;
	buttonContinuar.width=120.3;
	buttonMenu = game.add.button(445, game.world.height - 510, 'buttonMenu');
	buttonMenu.height=49.35;
	buttonMenu.width=120.3;
	buttonNiveis = game.add.button(625, game.world.height - 510, 'buttonNiveis');
	buttonNiveis.height=49.35;
	buttonNiveis.width=120.3;
	buttonSair = game.add.button(800, game.world.height - 510, 'buttonSair');
	buttonSair.height=49.35;
	buttonSair.width=120.3;
	textoMusica = game.add.button(445, game.world.height - 300, 'textMusica');
	textoMusica.height=28.2;
	textoMusica.width=119.4;
	textoSons = game.add.button(445, game.world.height - 400, 'textSons');
	textoSons.height=28.2;
	textoSons.width=83.4;
	if (musica=="on"){
		buttonMusicaOn= game.add.button(600, game.world.height - 310, 'buttonMusicaOn');
		buttonMusicaOn.height=51;
		buttonMusicaOn.width=69.5;
		buttonMusicaOffDesativado = game.add.button(725, game.world.height - 310, 'buttonMusicaOffDesativado');
		buttonMusicaOffDesativado.height=51;
		buttonMusicaOffDesativado.width=69.5;
	}
	else{
		buttonMusicaOnDesativado= game.add.button(600, game.world.height - 310, 'buttonMusicaOnDesativado');
		buttonMusicaOnDesativado.height=51;
		buttonMusicaOnDesativado.width=69.5;
		buttonMusicaOff = game.add.button(725, game.world.height - 310, 'buttonMusicaOff');
		buttonMusicaOff.height=51;
		buttonMusicaOff.width=69.5;
	}
	if (sons=="on"){
		buttonSonsOn = game.add.button(575, game.world.height - 410, 'buttonSonsOn');
		buttonSonsOn.height=51;
		buttonSonsOn.width=69.5;
		buttonSonsOffDesativado = game.add.button(700, game.world.height - 410, 'buttonSonsOffDesativado');
		buttonSonsOffDesativado.height=51;
		buttonSonsOffDesativado.width=69.5;
	}
	else{
		buttonSonsOnDesativado = game.add.button(575, game.world.height - 410, 'buttonSonsOnDesativado');
		buttonSonsOnDesativado.height=51;
		buttonSonsOnDesativado.width=69.5;
		buttonSonsOff = game.add.button(700, game.world.height - 410, 'buttonSonsOff');
		buttonSonsOff.height=51;
		buttonSonsOff.width=69.5;
	}
	game.input.onDown.add(unpause, self);
  });
		// And finally the method that handels the pause menu
    function unpause(event){
        // Only act if paused
        if(game.paused){
					sons=localStorage.getItem("sons");
					musica=localStorage.getItem("musica");
					if(event.x > 1200 && event.x < 1320 && event.y > 10 && event.y < 59.35 ){
						caixa.destroy();
						buttonMenu.destroy();
						buttonNiveis.destroy();
						buttonSair.destroy();
						buttonContinuar.destroy();
						textoSons.destroy();
						textoMusica.destroy();
						if (musica=="on"){
							buttonMusicaOn.destroy();
							buttonMusicaOffDesativado.destroy();
						}
						else{
							buttonMusicaOnDesativado.destroy();
							buttonMusicaOff.destroy();
						}
						if (sons=="on"){
							buttonSonsOn.destroy();
							buttonSonsOffDesativado.destroy();

						}
						else{
							buttonSonsOnDesativado.destroy();
							buttonSonsOff.destroy();
						}
						game.paused = false;
					}
					else if(event.x > 445 && event.x < 565 && event.y > 240 && event.y < 289.35 ){
						this.game.canvas.style.cursor = "pointer";
						player.kill();
						contadorImunidade=0;
						contadorVelocidade=0;
						game.time.reset();
						clearTimeout(timeout);
						clearTimeout(timeout2);
						poderCons=0;
						location.href = "../html/MenuPrincipal.html";
					}
					else if(event.x > 625 && event.x < 745 && event.y > 240 && event.y < 289.35){
						this.game.canvas.style.cursor = "pointer";
						player.kill();
						contadorImunidade=0;
					  contadorVelocidade=0;
						game.time.reset();
						clearTimeout(timeout);
						clearTimeout(timeout2);
						poderCons=0;
						location.href = "../html/menuniveis.html";
					}

					else if(event.x > 800 && event.x < 920 && event.y > 240 && event.y < 289.35){
						this.game.canvas.style.cursor = "pointer";
						player.kill();
						contadorImunidade=0;
					  contadorVelocidade=0;
						game.time.reset();
						clearTimeout(timeout);
						clearTimeout(timeout2);
						poderCons=0;
						window.close();
					}
					//Sons
					else if(event.x > 575 && event.x < 644.5 && event.y > 340 && event.y < 391){
						if (sons=="off"){
							buttonSonsOnDesativado.destroy();
							buttonSonsOff.destroy();
							buttonSonsOn = game.add.button(575, game.world.height - 410, 'buttonSonsOn');
							buttonSonsOn.height=51;
							buttonSonsOn.width=69.5;
							buttonSonsOffDesativado = game.add.button(700, game.world.height - 410, 'buttonSonsOffDesativado');
							buttonSonsOffDesativado.height=51;
							buttonSonsOffDesativado.width=69.5;
							localStorage.setItem("sons", "on");
							return;
						}
					}
					else if(event.x > 700 && event.x < 769.5 && event.y > 340 && event.y < 391){
						if (sons=="on"){
							buttonSonsOn.destroy();
							buttonSonsOffDesativado.destroy();
							buttonSonsOnDesativado = game.add.button(575, game.world.height - 410, 'buttonSonsOnDesativado');
							buttonSonsOnDesativado.height=51;
							buttonSonsOnDesativado.width=69.5;
							buttonSonsOff = game.add.button(700, game.world.height - 410, 'buttonSonsOff');
							buttonSonsOff.height=51;
							buttonSonsOff.width=69.5;
							localStorage.setItem("sons", "off");
							return;
						}
					}
					else if(event.x > 600 && event.x < 669.5 && event.y > 440 && event.y < 491){
						if (musica=="off"){
							buttonMusicaOnDesativado.destroy();
							buttonMusicaOff.destroy();
							buttonMusicaOn= game.add.button(600, game.world.height - 310, 'buttonMusicaOn');
							buttonMusicaOn.height=51;
							buttonMusicaOn.width=69.5;
							buttonMusicaOffDesativado = game.add.button(725, game.world.height - 310, 'buttonMusicaOffDesativado');
							buttonMusicaOffDesativado.height=51;
							buttonMusicaOffDesativado.width=69.5;
							localStorage.setItem("musica", "on");
							audio.restart();
							return;
						}
					}
					else if(event.x > 725 && event.x < 794.5 && event.y > 440 && event.y < 491){
						if (musica=="on"){
							buttonMusicaOn.destroy();
							buttonMusicaOffDesativado.destroy();
							buttonMusicaOnDesativado= game.add.button(600, game.world.height - 310, 'buttonMusicaOnDesativado');
							buttonMusicaOnDesativado.height=51;
							buttonMusicaOnDesativado.width=69.5;
							buttonMusicaOff = game.add.button(725, game.world.height - 310, 'buttonMusicaOff');
							buttonMusicaOff.height=51;
							buttonMusicaOff.width=69.5;
							localStorage.setItem("musica", "off");
							audio.stop();
							return;
						}
					}
      }
  };

	cursors = game.input.keyboard.createCursorKeys();
}

function over() {
    this.game.canvas.style.cursor = "pointer";
}

function resetGame(){
  if(sons=="on"){
		apanharMas.play();
	}
  audio.stop();
  musicaPoder.stop();
  game.time.reset();
  contadorImunidade=0;
  contadorVelocidade=0;
  contadorTamanho=0;
  clearTimeout(timeout);
  clearTimeout(timeout2);
  poderCons=0;
  poderConsVel=0;
  score=0;
  game.state.restart();
}

function finish(player) {
  apanharMas.stop();
  audio.stop();
  musicaPoder.stop();
  player.kill();
  contadorImunidade=0;
  contadorVelocidade=0;
  contadorTamanho=0;
  var tempoTotal=parseInt(game.time.totalElapsedSeconds());
	//O tempo de conclusao maximo para ganhar score com o tempo e 1min e 30 seg
  if (tempoTotal<90){
		score+=(90-tempoTotal)*50;
	}
  game.time.reset();
  clearTimeout(timeout);
  clearTimeout(timeout2);
  poderCons=0;
  poderConsVel=0;
  for (var key in localStorage) {
	    var score2=localStorage.getItem(key);
	    if (score2==0){
				var str1 = key;
				var str2 = "-nivel9";
				var nome = str1.concat(str2);
				var registado=localStorage.getItem(nome);
				if (registado=="null"){
					localStorage.setItem(nome, score);
	        location.href = "../html/menuniveis.html";
				}
				else if (registado<score) {
					localStorage.setItem(nome, score);
	        location.href = "../html/menuniveis.html";
				}
	    }
	}
  location.href = "../html/menuniveis.html";
}

function comerQueijo (player, queijo) {
  if(sons=="on"){
    apanharBoas.play();
  }
  score+=100;
  if (saudenivel.width!= 280){
      saudenivel.width+=70;
  }
  queijo.kill();
}

function comerQueijoMau (player, queijoMau) {
    // Removes the star from the screen
    if (poderCons==0){
      if(sons=="on"){
        apanharMas.play();
      }
      saudenivel.width-=70;
      if (saudenivel.width<=0){
          player.kill();
          resetGame();
      }
      queijoMau.kill();
    }
}

function ataqueMulher (player,mulher) {
  if (mulher.body.touching.up){
    if(sons=="on"){
      matarMulher.play();
    }
    score+=50;
    mulher.body.enable = false;
    player.body.velocity.y = -70;
    mulher.animations.stop();
    mulher.kill();
  }
  else{
    if (poderCons==0){
      if(sons=="on"){
        apanharMas.play();
      }
      saudenivel.width-=140;
      mulher.kill();
      if (saudenivel.width<=0){
        player.kill();
        resetGame();
      }
    }
  }
}

function tocarArmadilha (player, armadilha) {
  if (poderCons==0){
    if(sons=="on"){
			apanharMas.play();
		}
    player.kill();
    resetGame();
  }
}

function tocarPoderImunidade (player, poder) {
  if(sons=="on"){
    audio.pause();
    musicaPoder.play();
	}
  tfinalImunidade = game.time.totalElapsedSeconds() + 10;
  poder.kill();
  contadorImunidade=1;
  poderCons=1;
  score+=150;
  timeout= setTimeout(desativaPoder, 10000);
}

function tocarPoderVelocidade (player, poder) {
  if(sons=="on"){
    audio.pause();
    musicaPoder.play();
	}
  tfinalVelocidade = game.time.totalElapsedSeconds() + 15;
  poder.kill();
  contadorVelocidade = 1;
  poderConsVel=1;
  score+=150;
  timeout2= setTimeout(desativaPoderVelocidade, 15000);
}

function tocarPoderTamanho (player, poder) {
  if(sons=="on"){
    audio.pause();
    musicaPoder.play();
	}
    tfinalTamanho = game.time.totalElapsedSeconds() + 10;
    contadorTamanho = 1;
    poder.kill();
    score+=150;
    player.width=121;
    player.height=64,75;
    var timer= setTimeout(desativaPoderTam, 10000);
}

function desativaPoder(){
  if(sons=="on"){
		musicaPoder.stop();
		audio.resume();
	}
  contadorImunidade=0;
  poderCons=0;
}

function desativaPoderVelocidade(){
  if(sons=="on"){
		musicaPoder.stop();
		audio.resume();
	}
  contadorVelocidade = 0;
  poderConsVel=0;
}

function desativaPoderTam(){
  if(sons=="on"){
		musicaPoder.stop();
		audio.resume();
	}
    contadorTamanho  = 0;
    player.width=104;
    player.height=56;
}

function update() {

  player.checkWorldBounds=true;
  if (player.body.y> game.world.height){
        resetGame()
  }

  time.destroy();
time= game.add.bitmapText( 1350/2-20+70, 20, 'myfont', String(parseInt(game.time.totalElapsedSeconds())), 40);
  time.fixedToCamera=true;
  time.tint=0xfa0013;

  displayscore.destroy()
  displayscore= game.add.bitmapText(1050, 20, 'myfont',String( score), 40);
  displayscore.fixedToCamera=true;
  displayscore.tint=0xfa0013;

  if (contadorImunidade==1){
    timeImunidade.destroy();
    timeImunidade = game.add.bitmapText(50, 200, 'myfont', String(parseInt(tempoImunidade)), 40);
    timeImunidade.fixedToCamera=true;
    timeImunidade.tint=0xfa0013;
    tempoImunidade = tfinalImunidade-game.time.totalElapsedSeconds()+1;
  }

  else{
    timeImunidade.destroy();
  }

  if (contadorVelocidade==1){
    timeVelocidade.destroy();
    timeVelocidade = game.add.bitmapText(50, 300, 'myfont', String(parseInt(tempoVelocidade)), 40);
    timeVelocidade.fixedToCamera=true;
    timeVelocidade.tint=0xfa0013;
    tempoVelocidade = tfinalVelocidade-game.time.totalElapsedSeconds()+1;
  }

  else{
    timeVelocidade.destroy();
  }

  if (contadorTamanho==1){
        timeTamanho.destroy();
        timeTamanho = game.add.bitmapText(50, 400, 'myfont', String(parseInt(tempoTamanho)), 40);
        timeTamanho.fixedToCamera=true;
        timeTamanho.tint=0xfa0013;
        tempoTamanho = tfinalTamanho-game.time.totalElapsedSeconds()+1;
    }

    else{
        timeTamanho.destroy();
    }

  //  Collide the player and the stars with the platforms
  var hitPlatform = game.physics.arcade.collide(layer, player);


  game.physics.arcade.collide(queijosB, layer);
  game.physics.arcade.collide(queijosV, layer);
  game.physics.arcade.collide(queijosV, layer);
  game.physics.arcade.collide(armadilhas, layer);
  game.physics.arcade.collide(poderes, layer);
  game.physics.arcade.collide(passa, layer);

  game.physics.arcade.overlap(player, queijosB, comerQueijo, null, this);
  game.physics.arcade.overlap(player, queijosV, comerQueijoMau, null, this);
  game.physics.arcade.overlap(player, mulher, ataqueMulher, null, this);
  game.physics.arcade.overlap(player, mulher1, ataqueMulher, null, this);
  game.physics.arcade.overlap(player, armadilhas, tocarArmadilha, null, this);
  game.physics.arcade.overlap(player, poderesImunidade, tocarPoderImunidade, null, this);
  game.physics.arcade.overlap(player, poderesVelocidade, tocarPoderVelocidade, null, this);
  game.physics.arcade.overlap(player, poderesTamanho, tocarPoderTamanho, null, this);
  game.physics.arcade.overlap(player, passa, finish, null, this);

  if (mulher){
    if (mulher.x < 1640){
      mulher.body.velocity.x = 300;
      mulher.animations.play('right');
    }
    else if(mulher.x > 1850){
      mulher.body.velocity.x = -300;
      mulher.animations.play('left');
    }
  }

  if (mulher1){
    if (mulher1.x < 2430){
      mulher1.body.velocity.x = 300;
      mulher1.animations.play('right');
    }
    else if(mulher1.x > 2650){
      mulher1.body.velocity.x = -300;
      mulher1.animations.play('left');
    }
  }

  //  Reset the players velocity (movement)
  player.body.velocity.x = 0;

  if (cursors.left.isDown)
  {
    //  Move to the left
    if (poderConsVel==0){
      player.body.velocity.x = -300;
    }
    else{
      player.body.velocity.x = -400;
    }
    player.animations.play('left');
    player.goesRight = false;
  }
  else if (cursors.right.isDown){
    //  Move to the right
    if (poderConsVel==0){
      player.body.velocity.x = 300;
    }

    else{
      player.body.velocity.x = 400;
    }

    player.animations.play('right');
    player.goesRight = true;
  }

  else{
    //  Stand still
    player.animations.stop();
    if (player.goesRight){
      player.frame = 6;
    }
    else{
      player.frame = 5;
    }
  }

  //  Allow the player to jump if they are touching the ground.
  if (cursors.up.isDown && player.body.onFloor() && hitPlatform){
    if (poderConsVel==0){
      player.body.velocity.y = -450;
    }
    else{
      player.body.velocity.y = -500;
    }
  }

  //  Allow the player to jump if they are touching the ground.
  if (cursors.up.isDown && player.body.onFloor() && hitPlatform)
  {
    player.body.velocity.y = -450;
  }
}

</script>
</body>
</html>
